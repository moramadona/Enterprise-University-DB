-- 1. Student Transcript Query (Joins)
-- Get all courses for a specific student with department names
SELECT s.full_name, c.title, d.name AS department, e.grade
FROM Students s
JOIN Enrollments e ON s.student_id = e.student_id
JOIN Courses c ON e.course_id = c.course_id
JOIN Departments d ON c.dept_id = d.dept_id;

-- 2. Department Statistics (Aggregate Functions)
-- Calculating average grades and student counts per department
SELECT d.name, COUNT(s.student_id) AS student_count, AVG(e.grade) AS avg_gpa
FROM Departments d
LEFT JOIN Students s ON d.dept_id = s.dept_id
LEFT JOIN Enrollments e ON s.student_id = e.student_id
GROUP BY d.name;

-- 3. High Performance Students (Filtering)
-- List students with GPA > 3.5 in Data Science department
SELECT full_name, email FROM Students
WHERE student_id IN (SELECT student_id FROM Enrollments WHERE grade > 3.5)
AND dept_id = 1;

-- 4. Resource Allocation Check
-- Count how many courses each department offers vs their budget
SELECT d.name, d.budget, COUNT(c.course_id) AS course_count
FROM Departments d
LEFT JOIN Courses c ON d.dept_id = c.dept_id
GROUP BY d.dept_id;